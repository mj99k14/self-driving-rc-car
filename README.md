
# 🚘 自動運転RCカーシステム

このプロジェクトのREADMEは以下の言語でご覧いただけます。  
言語を選択してください：

🇯🇵 日本語 (現在表示中)  
🇰🇷 [한국어 版を読む](README_kr.md)

---

# 🚗 Jetson Nano ベースの自動運転RCカー プロジェクト

> **Jetson Nano + PyTorch + OpenCV** を活用したライン追跡型の自動運転RCカー  
> リアルタイムのライン認識・操舵・速度制御まで自動化を実現

---

## 🧠 プロジェクト概要

Jetson Nano、カメラ、DC/サーボモーターを用いて道路ラインをリアルタイムで認識し、  
CNNベースのディープラーニングモデル（PilotNet）により操舵角を予測し、自動走行を行うプロジェクトです。

---

## 🎬 実行動画（デモ）

![デモGIF](./jetson_rc_car_demo.gif)  
> Jetson Nano によるリアルタイム推論と自動操縦の成功シーン

🔗 [完全版動画を見る（mp4）](https://github.com/mj99k14/self-driving-rc-car/raw/main/video/jetson_autopilot_demo.mp4)

---

## 🛠 使用技術

| カテゴリ | ツール |
|----------|--------|
| プログラミング言語 | Python 3.8 |
| ディープラーニング | PyTorch + PilotNet |
| 映像処理 | OpenCV 4.10.0 |
| ハードウェア | Jetson Nano, DCモーター, サーボモーター, L298N |
| OS/環境 | Ubuntu 18.04 + JetPack 4.6.1, CUDA 10.2 |

---

## 💡 主な実装機能

- 📷 **ライン認識**：OpenCV + CNN による道路中心線の検出  
- 🕹 **操舵・速度制御**：PWM制御によるモーター制御  
- 🔀 **マルチスレッド処理**：映像分析と制御を並列処理  
- 🧠 **自作学習モデル**：13,362枚の画像を学習しPilotNetを最適化  

---

## 🔧 こだわった点 / 技術的工夫

- **並列処理によるボトルネック解消と構成**  
  マルチスレッド構成の導入とボトルネック解消
  初期段階では、映像処理とモーター制御を1つのループ内で逐次的に実行していたため、
  推論が遅れると制御命令の反映も遅延し、ボトルネックが発生していました。
  この課題を解決するために、マルチスレッド構成を導入し、
  映像推論とハードウェア制御を別々のスレッドで非同期かつ並列に実行するように設計を改善しました。
  これにより、Jetson Nanoのリソースを効率的に分散使用し、リアルタイム性と安定性の両立を実現しました。

- **操舵角ラベルの設計とデータ収集**  
  サーボモーターの操舵角を30°, 60°, 90°, 120°, 150°の5段階に分けてラベル付けを行い、  
  各角度に対応する走行映像を記録・収集して学習に使用しました。  

- **過学習を防ぐための追加データ収集**  
  様々な明るさや状況を想定して独自にデータを追加収集し、回転やノイズ付与といったデータ拡張処理を行いました。

- **背景ノイズを減らす前処理**  
  学習用画像の上部30%をカットし、モデルが路面情報に集中して学習できるよう工夫しました。

- **データ不均衡の対処**  
  実際の走行環境では90°の直進データが最も多く出現したため、90°のデータ量を基準に他の角度のデータ数を調整し、  
  モデルが偏りなく学習できるようにデータセットを再構成しました。

---

## 📈 成果と性能

- モデル構成：CNNベースのPilotNet（5つの畳み込み層 + 4つの全結合層）
- 学習データ：13,362枚（操舵角度ラベル：30°, 60°, 90°, 120°, 150°）
- 最終バリデーションロス：**0.2107**
- テスト環境での自動走行成功率：**78.8%**
- 曲線区間での認識精度を高めるため、データ拡張とハイパーパラメータ調整を実施
- 室内トラックにて安定した自律走行を達成  
- Jetson GPU によるリアルタイム映像推論を実装  
- Jetson GPIO と PWM による高精度な操舵制御を達成
- 最適化された最終モデルファイル：`pilotnet_model_optimized.pth`

---

## 📂 プロジェクト構成

```
self-driving-rc-car/
├── Completion/              # プロジェクト完成コード
│   ├── code/                # 実行コード
│   ├── data conversion/     # データ変換用コード
│   ├── data preprocessing/  # データ前処理コード
│   └── Model/               # モデル定義または学習済みファイル
│
├── data/                    # 学習データ（例：MNIST、CSV）
│   ├── MNIST/raw/
│   └── training_data_updated.csv
│
├── Practice/                # 試作コードとテストスクリプト群
│   ├── データ拡張/
│   ├── PilotNet関連スクリプト
│   ├── 角度分類・前処理・再撮影などのPythonコード
```
```

---

## 📎 関連資料

- 💻 [GitHubリポジトリ](https://github.com/mj99k14/self-driving-rc-car)

---

## 🙋 開発者

| 名前 | 担当 |
|------|------|
| キム・ミンジョン | 全体設計 / モデル学習 / Jetson制御 |
